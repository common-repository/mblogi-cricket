(function(c){var b={init:function(j){j=c.extend({},c.fn.ctAccordion.defaults,j);return this.each(function(){var p="accordion_"+c(this).attr("id");var m=c(this).addClass(j.myClass).data("ctAccordion",{options:j,cookieName:p});var k=[];if(j.useCookies){var o=g(p);if(o!=null){c(o.split(" ")).each(function(q,r){k.push(parseInt(r))})}}var l=1;c("ul",m).each(function(){c(this).data("ctAccordion",{numID:l++})}).find("li").addClass(j.collapsedPathClass);var n=1;c("li",m).each(function(){if(c.inArray(n,k)!=-1){c(this).find("li:first").addClass(j.defaultExpanded.replace(".",""))}c(this).data("ctAccordion",{numID:n++})});m.find("ul").hide();c(j.defaultExpanded,m).each(function(){c(this).removeClass(j.collapsedPathClass)}).parents("li").addClass(j.expandedPathClass).removeClass(j.collapsedPathClass);if(c(j.defaultExpanded,m).length){a.apply(m,[c(j.defaultExpanded,m)])}c("a + ul",m).prev("a").addClass(j.headerClass).bind(j.event,function(){if(c(this).next("ul").is(":not(:hidden)")){f.apply(m,[c(this)])}else{a.apply(m,[c(this),j.oneOpenAtTime])}return false});if(j.useCookies){c("a",m).bind(j.event,function(){var q="";c("li."+j.expandedPathClass).each(function(r,t){var s=c(t).data("ctAccordion");q+=" "+s.numID});i(p,q.trim())})}});return this},search:function(n){var k=c(this),m=k.data("ctAccordion"),j=m.options,l=new RegExp(n,"i");e.apply(k);c("li>a, >li>ul>li",k).each(function(){var p=c(this).text().match(l);if(p!=""&&p!=null){var o=c(this);if(c(this)[0].nodeName=="LI"){o=c(this).closest("ul").prev("a")}a.apply(k,[o,false]);o.addClass(j.foundPhraseClass)}else{c(this).removeClass(j.foundPhraseClass)}});return this},open:function(m,l){var k=c(this),n=k.data("ctAccordion"),j=n.options;m--;return c(this).each(function(){if(m<0){return}var p=c(">li>a",k);if(m>p.length){return}var o=p.eq(m);a.apply(k,[o,j.oneOpenAtTime]);if(l!=undefined){l--;$level2=o.next("ul").find(">li>a");if(l<0||l>$level2.length){return}var o=$level2.eq(l);a.apply(k,[o,j.oneOpenAtTime])}})},option:function(j,l){if(typeof j==="string"){if(l===undefined){var m=c(this),k=m.data("ctAccordion");return k.options[j]}else{var m=c(this),k=m.data("ctAccordion");k.options[j]=l;m.data("ctAccordion",k);return this}}}};var h=function(j){var k=[];j.parents("ul").each(function(m,l){var n=c(l).data("ctAccordion");var m=parseInt(n.numID);if(!isNaN(m)){k.push(m)}});return k};var e=function(k){var l=c(this),m=l.data("ctAccordion"),j=m.options;if(k===undefined){f.apply(l,[c("li."+j.expandedPathClass+" > a."+j.headerClass)])}else{var n=h(k);c("ul:visible",l).each(function(r,q){var p=c(q),s=p.data("ctAccordion");var o=parseInt(s.numID);if(c.inArray(o,n)==-1){f.apply(l,[c(p.prev("."+j.headerClass)[0])])}})}};var f=function(j){var l=c(this),m=l.data("ctAccordion"),k=m.options;k.onClose.apply(l,[j]);j.nextAll("ul").slideUp("fast").find("li").removeClass(k.expandedPathClass).addClass(k.collapsedPathClass);j.closest("li").removeClass(k.expandedPathClass).addClass(k.collapsedPathClass)};var a=function(j,l){if(l===undefined||l==true){e.apply(c(this),[j])}var m=c(this),n=m.data("ctAccordion"),k=n.options;k.onOpen.apply(m,[j]);j.nextAll("ul").slideDown(k.speed,k.easing);d.apply(c(this),[j.closest("li")])};var d=function(o){var l=c(this),m=l.data("ctAccordion"),k=m.options;o.addClass(k.expandedPathClass).removeClass(k.collapsedPathClass);var j=o.closest("ul").slideDown("fast");if(j.length==0){return}var n=j.closest("li");if(n.length>0){d.apply(l,[c(n[0])])}return};var i=function(l,m,n){if(n){var k=new Date();k.setTime(k.getTime()+(n*24*60*60*1000));var j="; expires="+k.toGMTString()}else{var j=""}document.cookie=l+"="+m+j+"; path=/"};var g=function(k){var m=k+"=";var j=document.cookie.split(";");for(var l=0;l<j.length;l++){var n=j[l];while(n.charAt(0)==" "){n=n.substring(1,n.length)}if(n.indexOf(m)==0){return n.substring(m.length,n.length)}}return null};c.fn.ctAccordion=function(j){if(b[j]){return b[j].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof j==="object"||!j){b.init.apply(this,arguments)}else{c.error("Method "+j+" does not exist on 3 Level Accordion!")}}};c.fn.ctAccordion.defaults={headerClass:"head",defaultExpanded:".expanded",expandedPathClass:"open",collapsedPathClass:"closed",useCookies:false,foundPhraseClass:"searchMatch",event:"click",myClass:"ctAccordion",oneOpenAtTime:true,easing:"linear",speed:200,onOpen:c.noop,onClose:c.noop}})(jQuery);